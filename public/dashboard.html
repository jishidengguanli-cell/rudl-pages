<script>
// 載入就驗證登入，未登入導回 login.html?next=/dashboard.html
(async () => {
  try {
    const r = await fetch("/api/auth/me");
    const me = await r.json();
    if (!me.authenticated) {
      location.href = "/login.html?next=/dashboard.html";
      return;
    }
    document.getElementById("me").textContent = `目前登入：${me.email}`;
  } catch {
    location.href = "/login.html?next=/dashboard.html";
  }
})();

// 登出
document.getElementById('logout').onclick = async () => {
  await fetch('/api/auth/logout', { method: 'POST' });
  location.href = "/login.html";
};
</script>
